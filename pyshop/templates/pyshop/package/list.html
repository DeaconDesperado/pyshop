{% extends "/pyshop/layout.html" %}

{% block subnav %}
{% endblock %}


{% block main %}

<form class="filter" method="GET">
<!-- /input-group -->
<div class="input-group">
    <input type="text" id="classifier" class="form-control" name="classifier.added" value=""/>
    <span class="input-group-btn"><button class="btn btn-default" id="submitter" name="form.submitted"> {% trans %} filter {% endtrans %} </button></span>
    <div class="btn-group" data-toggle="buttons">
        {% for c in filter.classifiers %}
        <label class="btn btn-primary">
          <input type="checkbox" id="classifier_{{loop.index}}" onchange="$('#submitter').click()" name="classifiers" checked="checked" value="{{c.id}}"/> {{c.name}}
        </label>
        {% endfor %}
        <label class="btn btn-primary">
          <input type="checkbox" id="source_local" name="local_only" value="1" onchange="$('#submitter').click()" 
                 {%if filter.local_only%}checked="checked"{% endif %}/> {% trans %}locals only{% endtrans %}
        </label>
    </div>
</div>
</form>

<table class="table table-hover table-condensed">
<thead>
    <tr>
        <th>{% trans %} package {% endtrans %}</th>
        <th>{% trans %} last version {% endtrans %}</th>
        <th>{% trans %} # downloads {% endtrans %}</th>
        <th>{% trans %} source {% endtrans %}</th>
    </tr>
</thead>
<tbody>

    {% for pkg in packages %}
        <tr>
            <td>
                <a href="{{ route_url('show_package', package_name=pkg.name) }}">
                    {{ pkg.name }}
                </a>
            </td>
            <td class="num">{{ pkg.versions[0] }}</td>
            <td class="num">{{ pkg.downloads }}</td>
            <td class="num">
                {% if pkg.local %}
                    {% trans %} local {% endtrans %}
                {% else %}
                    {% trans %} mirror {% endtrans %}
                {% endif %}
            </td>
        </tr>
    {% endfor %}
</tbody>
</table>

<script>
    $(function() {
        var classifiers = [
        {% for c in classifiers %}
            '{{c.name}}',
        {% endfor %}
        ];
        $( "#classifier" ).autocomplete({
            source: classifiers
        });
    });
</script>
{% endblock %}
